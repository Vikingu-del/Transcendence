# Common attack patterns
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS|!REQUEST_HEADERS:Referer "@rx (?i:(?:\.\.\/|\.\.\\|%2e%2e%2f|%252e%252e%252f))" \
    "id:1000,\
    phase:1,\
    block,\
    msg:'Directory Traversal Attack Detected',\
    severity:'CRITICAL',\
    tag:'attack-lfi'"

# SQL Injection patterns
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS "@rx (?i:(?:union.*select|information_schema|sysdatabases|syslogins|sysobjects|systemtable))" \
    "id:1001,\
    phase:2,\
    block,\
    msg:'SQL Injection Attack Detected',\
    severity:'CRITICAL',\
    tag:'attack-sqli'"

# File inclusion attacks
SecRule REQUEST_URI|ARGS "@rx (?i:(?:etc/passwd|etc/shadow|proc/self/environ|/proc/\d+/fd/\d+))" \
    "id:1002,\
    phase:1,\
    block,\
    msg:'File Inclusion Attack Detected',\
    severity:'CRITICAL',\
    tag:'attack-lfi'"