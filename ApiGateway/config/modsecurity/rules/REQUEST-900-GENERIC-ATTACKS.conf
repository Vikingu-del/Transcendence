# Common attack patterns
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS "@rx (?:/\.\./?|\.\.\\|\.\.%2f|\.\.%5c|%2e%2e%2f|%2e%2e\/|%2e%2e%5c)" \
    "id:1000,\
    phase:1,\
    block,\
    log,\
    msg:'Directory Traversal Attack Detected',\
    severity:'CRITICAL',\
    tag:'attack-lfi',\
    status:403,\
    logdata:'%{MATCHED_VAR}'"

# SQL Injection patterns
SecRule REQUEST_URI|ARGS|REQUEST_HEADERS "@rx (?i:(?:union\s+(?:all\s+)?select|information_schema|sysdatabases|syslogins|sysobjects|systemtable|\;\s*select|\s+like\s+|<\s*script|\%27))" \
    "id:1001,\
    phase:2,\
    block,\
    log,\
    msg:'SQL Injection Attack Detected',\
    severity:'CRITICAL',\
    tag:'attack-sqli',\
    status:403,\
    logdata:'%{MATCHED_VAR}'"

# File inclusion attacks and path attacks
SecRule REQUEST_URI|ARGS "@rx (?i:(?:/etc/\w+|/proc/self/|\.\./))" \
    "id:1002,\
    phase:1,\
    block,\
    log,\
    msg:'File Inclusion Attack Detected',\
    severity:'CRITICAL',\
    tag:'attack-lfi',\
    status:403,\
    logdata:'%{MATCHED_VAR}'"